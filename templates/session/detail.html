{% extends "public/body.html" %}

{% block title  %}
{% load i18n %}
     {% trans ADD_NEW_SESSION %}
{% endblock %}

{% block pagetitle %}
    {% trans ADD_NEW_SESSION %}
{% endblock %}

{% block content %}
    <div class="content">
        <div class="container-fluid">
          <div class="row">
            <div class="col-md-12">
              <div class="card">
                <div class="card-header card-header-primary">
                  <h4 class="card-title">{% trans SESSION %} {{ session.year }}</h4>
                  <p class="card-category">{% trans ADD_COURSE_AND_EXAMS_IN_THIS_SESSION %}</p>
                </div>
                <div class="card-body">
                    <div class="row text-center">
                        <div class="col-md-4">
                            <p>Session Year</p>
                            <h3>{{ session.year }}</h3>
                        </div>
                        <div class="col-md-4">
                            <p>Session Start Date</p>
                            <h3>{{ session.sessionStartDate }}</h3>
                        </div>
                        <div class="col-md-4">
                            <p>Session Start End</p>
                            <h3>{{ session.sessionEndDate }}</h3>
                        </div>
                    </div>
                    <hr/>
                    <form class="" method="post" id="form">
                        <div class="row">
                      {% csrf_token %}

                                <div class="col-md-8 col-sm-8">
                                    <label class="form-label">Select Course</label>
                                    <select id="exam" class="form-control select2" name="exam_id">
                                        <option selected disabled>Select Please</option>
                                        {% for course in courses %}
                                            <option value="{{ course.id }}">{{ course.course.courseName}} - {{ course.exam.examName }}</option>
                                        {% endfor %}

                                    </select>
                                </div>
                                  <div class="col-md-4 col-sm-4">
                                    <br/>
                                    <input type="button" onclick="SubmitFrom()" value="Add" CLASS="btn btn-primary">
                                </div>
                        </div>
                    </form>
                    <hr/>
                    <div class="row text-center">
                        <div class="col-md-12">
                            <p>Session Description</p>
                            <h4>{{ session.sessionDescription }}</h4>
                        </div>
                    </div>
                </div>
              </div>
            </div>
          </div>


        <div class="row">
        {% for exam in session.session.all %}
            <div class="col-md-6">
              <div class="card">
                <div class="card-header card-header-warning">
                    <div class="row">
                        <div class="col-md-9">
                            <h4 class="card-title" title="Exam Name">{{ exam.courseExam.exam.examName }}</h4>
                            <p class="card-category" title="Class Name">{{ exam.courseExam.course.courseName }}</p>
                        </div>
                        <div class="col-md-3">
                            <a href="{% url 'marks.index' exam.courseExam.id %}"><i class="material-icons">Book</i></a>
                        </div>
                    </div>

                </div>
                <div class="card-body table-responsive">
                  <table class="table table-hover text-center">
                    <thead class="text-warning">
                      <tr>
                      <th>#</th>
                      <th>Subject</th>
                      <th>Type</th>
                      <th>Minimum Marks</th>
                      <th>Maximum Marks</th>
                    </tr></thead>
                    <tbody>
                    {% for subject in exam.courseExamSubject.all %}
                      <tr class="text-center">
                        <td>{{ subject.id }}</td>
                        <td>{{ subject.subject.subjectName }}</td>
                        <td>{{ subject.subject.type.typeName }}</td>
                        <td>{{ subject.minMarks }}</td>
                        <td>{{ subject.maxMarks }}</td>

                      </tr>
                    {% endfor %}

                    </tbody>
                  </table>
                </div>
              </div>
            </div>

        {% endfor %}
        </div>
        </div>
      </div>



{% endblock %}
{% block style %}
<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/css/select2.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.0/jquery-confirm.min.css">
{% endblock %}

{% block script %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/js/select2.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.0/jquery-confirm.min.js"></script>
    <script>
         $('.select2').select2();
         function SubmitFrom() {
             var exam = $('#exam').val();
             $.confirm({
                    title: 'Confirm!',
                    content: '<p class="alert alert-danger text-center">Are you sure to Add this? This is not Deletable</p>',
                    buttons: {
                        confirm: function () {
                            if(exam){
                                $('#form').submit();
                            }else{
                                $.alert('Please Select A Exam')
                            }

                        },
                        cancel: function () {
                            $.alert('You cancel this opration!')
                        },
                    }
                });
         }
    </script>
{% endblock %}

